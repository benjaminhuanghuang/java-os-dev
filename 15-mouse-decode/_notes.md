
# Hello OS
[挪动鼠标](https://blog.csdn.net/tyler_download/article/details/52850545)


https://www.bilibili.com/video/BV1hJ411n7rs?p=15


鼠标发送的数据，必须三个字节连在一起解读，所以我们的内核要等待鼠标发送足够的数据后才可以采取行动。

当鼠标被激活后，它会立马给内核发送一个字节数据，数值为0xfa, 当内核收到这个数据后，就可以开始积攒数据，每接收三个字节后，根据数据绘制鼠标。

这三个字节数据的第一个字节0xab, a的数值必须在0-3这个范围内，由于a对应的是八比特中的高四位，所以这意味着该字节的第7，8两个比特位必须为0，b对应着八比特位中的低四位，它的值必须在8-F之间，这意味着该字节数据对应的第4个比特位必须为1.把第一个字节转换成二进制，那么它必须满足下面格式(X,*代表0或1）：
0 0 X X 1 * \ * *
三个*用来表示鼠标按键，当鼠标的左键，滚轮，右键被按下时，对应的比特位会设置为1.

第二个字节用来表示鼠标的左右移动，对该字节进行相应处理后，可以得到鼠标平移的坐标变换。

第三个字节的数据表示鼠标的上下移动，对该字节进行相应处理后，可以得到鼠标垂直移动时的坐标数变化。

```
struct MOUSE_DEC {
    unsigned char buf[3], phase;
    int x, y, btn;
};
```
buf[3]用来存储鼠标发送的三个数据，phase表示当前接收到第几个数据了，x表示水平移动的坐标变换，y表示上下移动时鼠标的坐标变换，btn用来表示鼠标哪个按键被按下了。